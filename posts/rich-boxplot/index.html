<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
        Rich Boxplot - Tomas&#39; Visualization Blog
      </title>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    
    <meta name="theme-color" content="#000000" />
    
    <meta http-equiv="window-target" content="_top" />
    
    
    <meta name="description" content="A proposed plot type to intelligibly describe relation between two one-dimensional distributions" />

<link rel="icon" type="image/png" href="/favicons/f.png">






    
    <meta name="generator" content="Hugo 0.115.3 with theme pure" />
    <title>Rich Boxplot - Tomas&#39; Visualization Blog</title>
    
    
    <link rel="stylesheet" href="https://t0mk.github.io/css/style.min.67a57a189656df46d6ecf6ce5d60cc4ef22577eb4a1270208ad0a5d07d1d93f0.css">
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css" async>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
    
    <meta property="og:title" content="Rich Boxplot" />
<meta property="og:description" content="A proposed plot type to intelligibly describe relation between two one-dimensional distributions" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://t0mk.github.io/posts/rich-boxplot/" /><meta property="og:image" content="https://t0mk.github.io/img/rbp.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-12-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-12-27T00:00:00+00:00" />
<meta itemprop="name" content="Rich Boxplot">
<meta itemprop="description" content="A proposed plot type to intelligibly describe relation between two one-dimensional distributions"><meta itemprop="datePublished" content="2020-12-27T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-12-27T00:00:00+00:00" />
<meta itemprop="wordCount" content="976"><meta itemprop="image" content="https://t0mk.github.io/img/rbp.png">
<meta itemprop="keywords" content="visualization,statistics,correlation," /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://t0mk.github.io/img/rbp.png"/>

<meta name="twitter:title" content="Rich Boxplot"/>
<meta name="twitter:description" content="A proposed plot type to intelligibly describe relation between two one-dimensional distributions"/>

    <!--[if lte IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
      <![endif]-->

    <!--[if lt IE 9]>
        <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
      <![endif]-->

  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="https://github.com/t0mk" target="_blank">
            <img class="img-circle img-rotate" src="https://t0mk.github.io/avatar.jpg" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">Tomáš Karásek</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md">Relevant Data Visualizations</h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i></small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="Type something..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Archives</span>
                </a>
            </li>
            <li class="menu-item menu-item-aboutsite">
                <a href="/aboutsite/">
                    <i class="icon icon-project"></i>
                  <span class="menu-title">About This Site</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About Me</span>
                </a>
            </li>
            <li class="menu-item menu-item-github">
                <a href="/github/">
                    <i class="icon icon-github"></i>
                  <span class="menu-title">Github Feed</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
<div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://t0mk.github.io/posts/tampere-sold-price/" class="title">Price of real estate for sale in Tampere 2018-2022</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2022-03-10 00:00:00 &#43;0000 UTC" itemprop="datePublished">2022-03-10</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://t0mk.github.io/posts/count-sell-ads/" class="title">Change in the Volume of Real Estate for Sale in Finland from 2018 to 2022</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2022-01-31 00:00:00 &#43;0000 UTC" itemprop="datePublished">2022-01-31</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://t0mk.github.io/posts/tampere-rental-price-growth/" class="title">Growth of Rental Prices in Tampere in the last 3 Years</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-02-17 00:00:00 &#43;0000 UTC" itemprop="datePublished">2021-02-17</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://t0mk.github.io/posts/tampere-rental-apartments/" class="title">Price of Rental Apartments in Tampere</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">2021-01-01</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://t0mk.github.io/posts/rich-boxplot/" class="title">Rich Boxplot</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2020-12-27 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-12-27</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>
  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse in" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">Table of Contents</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>

<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h1 itemprop="name">
  <a
    class="article-title"
    href="/posts/rich-boxplot/"
    >Rich Boxplot</a
  >
</h1>

      <div class="article-meta">
        
<span class="article-date">
  <i class="icon icon-calendar-check"></i>&nbsp;
<a href="https://t0mk.github.io/posts/rich-boxplot/" class="article-date">
  <time datetime="2020-12-27 00:00:00 &#43;0000 UTC" itemprop="datePublished">2020-12-27</time>
</a>
</span>
  
  <span class="article-tag">
    <i class="icon icon-tags"></i>&nbsp;
    <a class="article-tag-link" href="/tags/visualization/"> visualization </a>
    <a class="article-tag-link" href="/tags/statistics/"> statistics </a>
    <a class="article-tag-link" href="/tags/correlation/"> correlation </a>
  </span>

        <span class="post-comment"><i class="icon icon-comment"></i>&nbsp;<a href="/posts/rich-boxplot/#comments"
            class="article-comment-link">Comments</a></span>
		<span class="post-wordcount hidden-xs" itemprop="wordCount">Word Count: 976words</span>
		<span class="post-readcount hidden-xs" itemprop="timeRequired">Read Count: 5minutes </span>
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <p>It&rsquo;s often useful to visually understand how one statistic relates to another. For example, to see how rental apartment area affects its monthly price. The first visualization that would come to my mind is scatter plot, and I argue that scatter plot is not descriptive enough to offer good understanding of the simple case of two 1d statistics. I propose a rich boxplot visualization that gives better overview of the correlation to the reader.</p>
<h2 id="example-data">Example data</h2>
<p>Given about 24000 rental ads for apartments in Tampere, Finland in the last 3 years, perhaps in a DataFrame with two columns &ldquo;area&rdquo; and &ldquo;price&rdquo;, these are the distributions of apartment size in square meters, and apartment price in EUR per month.</p>
<p><img src="/img/rbp_area.png" alt="alt"> | <img src="/img/rbp_price.png" alt="alt"></p>
<p>You can see that the histogram of apartment size is peaky, developers stick to certain apartment sizes. As there are many new high blocks of flats, the apartment sizes are the same for apartments above and below in the same block. The peaks can be seen as popular apartment sizes in Tampere. There&rsquo;s 25 m², 32 m², 39 m², 45 m², 52 m², 59 m² and then 75 m².</p>
<p>The price is less peaky and more &ldquo;naturally&rdquo; (normally) distributed. Median is 680 EUR, but there is another peak around 600.</p>
<p>I have already removed some outlier categories, for example:</p>
<ul>
<li>short-term hotel-like apartments (Forenom), where 25 m² studio comes to 1200 EUR/month</li>
<li>single rooms - listings of area &lt;20 m²</li>
<li>listings out of sensible range for price and area</li>
</ul>
<h2 id="scatter-plot">Scatter Plot</h2>
<p>Now it would be good to see how the apartment size relates to the rental price. Let&rsquo;s scatter plot. Scatter plot is a 2d plot where each data point (row in our dataframe) is displayed on [x,y] coordinates [area,price]. This is a scatter plot of area and price of rental apartments in Tampere:</p>
<p><img src="/img/rbp_scatter.png" alt="alt"></p>
<p>The blue dots are the datapoints, and the black line is a linear function fitted from all the datapoints. The line (linear function) says that, given no data but the apartment size, you can estimate rental price of an apartment in Tampere by solving</p>
<blockquote>
<p>Price [EUR] = 362 + 7.1 * Size [m²]</p>
</blockquote>
<p>.. so for 50 m² we get 717 EUR, which seems about right by looking at the scatter plot. It would be interesting to see what those coefficients (362 and 7.1) would be for other cities in Finland.</p>
<p>We can get a good feel of the relationship between the two distributions from the scatter plot and fitted linear function. However, coming from the histograms, we lose information about local density of the data. We don&rsquo;t know how strong is the evidence for particular apartment size (or size interval). The linear function is surely more precise for median-sized apartments than for large ones (more than 100 m²) because those are much less common. We also have very limited information about how much the price spreads for a particular apartment size.</p>
<p>Even though we only investigate apartment size as a factor of price, it&rsquo;s also interesting to see to what extent is the the price affected by the other features (year built, location, amenities, ..). We can get the idea by examining how much the price varies for a given size interval, e.g. what is the <a href="https://en.wikipedia.org/wiki/Interquartile_range">price range for the most common half</a> of apartments between 49 and 51 m². Looking at the scatter plot, I could guess that it will be from ~600 to ~800, but I have no means to qualitatively compare this guess to other size ranges.</p>
<p>Furthermore, a linear function will not have good information value for non-linear relationships, e.g. age of an apartment - very old (1950s) and very new (2010s) apartments will be more expensive than apartments built in the middle of the era (1980s).</p>
<h2 id="rich-boxplot">Rich boxplot</h2>
<p>The variance can be explained by using a <a href="https://en.wikipedia.org/wiki/Box_plot">boxplot</a>. For some reason, boxplots are mostly used in scientific papers, and display dependency of numeric variable on a categorical variable, think sth like petal lenghts of species of the Iris flower.</p>
<p>In order to transform the scatter plot to be more informative, I decided to bin the control variable (size), and display the median and the 0.25 and 0.75 quantiles of prices in the bin. It&rsquo;s not too hard to compute that, for apartments between 49 and 51 m², there is 1208 datapoints, the median price is 710 cheapest 25% of the apartments are below 650 (0.25 quantile) and the cheapest 75% of the apartments are below 780 (0.75 quantile). This means that the most common half of 49-51 m² apartments in Tampere are between 650 and 780 EUR per month.</p>
<p>Let&rsquo;s take the 2D space from the scatter plot and imagine a rectangle with vertical edges on the apartment size interval bounds, and horizontal edges on the 25% and 75% percentile prices, with a dot on the median price level. for the example from previous paragraph, it would be a rectangle between points [49,650], [51,650], [51, 780] and [49, 780], with a dot on [50, 715]. If we divide all the size range into intervals, and then transform all of them into such rectangles, the plot will look like this:</p>
<div class='bokehplot'>
<script src="/js/g.js" id="cc39ac53-7385-4d8d-9e5b-ae4043e7268f"></script>
</div>

<p>You can hover over a rectangle and the tooltip will show parameters of the bin. I added histograms for both of the statistics (above and on the left), and I adjust intensity of the bin based on how many samples are in it. the darker the bin, the more samples it contain. I don&rsquo;t show borders of the size interval, but rather the middle value from the interval. The width of the bin/interval is not important, and can be roughly estimated from the mid-value distance.</p>
<p>The rich boxplot will show how much the price values disperse based on the apartment size. It doesn&rsquo;t only report the relationship between the variables but also the quality of the data in the range.</p>

    </div>
    <div class="article-footer">
    </div>
  </article>
<section id="comments">
</section>

</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://t0mk.github.io/about/" title="About Me"><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;Older</span></a>
            </li>
            <li class="next">
                <a href="https://t0mk.github.io/posts/tampere-rental-apartments/"
                    title="Price of Rental Apartments in Tampere"><span>Newer&nbsp;&nbsp;</span><i
                        class="icon icon-angle-right" aria-hidden="true"></i></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn" data-toggle="collapse" href="#collapseToc" aria-expanded="true"
                    title="Table of Contents" role="button">
                    <span>[&nbsp;</span><span>Table of Contents</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="facebook,twitter"
                data-mobile-sites="facebook,twitter"></div>
        </div>
    </div>
</nav>

</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/t0mk" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://t0mk.github.io/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2020  -
    2025
    <div class="publishby">
        Theme by <a href="https://github.com/xiaoheiAh" target="_blank"> xiaoheiAh </a>base on<a href="https://github.com/xiaoheiAh/hugo-theme-pure" target="_blank"> pure</a>.
    </div>
  </div>
</footer>




<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/python.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/javascript.min.js" defer></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://t0mk.github.io/js/application.min.c5e6b8b654ecc4c534fcefb82aae117cbc13cf92eb4019d05702ee813b91f1ef.js"></script>
<script src="https://t0mk.github.io/js/plugin.min.738a460bf4317fac61717f1bca393e53d00973db9754d9f0a81c7312d5874840.js"></script>



<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            ROOT_URL: 'https:\/\/t0mk.github.io',
            CONTENT_URL: 'https:\/\/t0mk.github.io\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://t0mk.github.io/js/insight.min.716b0c6a00b68ccc31a2b65345f3412f4246ffa94a90f8e25d525528b4504f9937880692bbe619023233caba5d0a17ebe23d7cfb57cd3a88f23ea337ad5e4d00.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
        collapseDepth: 3,
    });
</script>



  </body>
</html>
